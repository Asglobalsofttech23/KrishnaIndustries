import{r as s,j as e,G as l,d as g,c as R,w as q,S as K}from"./index-BFgOO9FV.js";import{a as L}from"./axios-CMf68hJO.js";import{h as N}from"./moment-G82_0lEo.js";import{S as V,T as X,a as Z,b as ee,c as A,d as a,e as te}from"./Search-BptgNfeq.js";import{L as _,A as v,D as w}from"./DateTimePicker-Cw3MEjmR.js";import{T as W,S as se}from"./TextField-uMyB6taY.js";import{F as ae}from"./OutlinedInput-CU74RVD_.js";import{M as y}from"./MenuItem-DdWCPvaA.js";import{P as re}from"./Pagination-Jcemn9fm.js";import{D as ne,a as ie,b as le}from"./DialogContent-BR2G1wlf.js";import{D as oe}from"./DialogTitle-Bwjr3vop.js";import"./Tabs-RtGtfztt.js";import"./InputAdornment-DDYrV0kf.js";import"./ListItem-YrdFOudX.js";import"./Popper-D6Ge9WxY.js";const ce=({onFilterChange:j})=>{const[E,T]=s.useState(null),[h,D]=s.useState(null),[p,P]=s.useState([]),[M,u]=s.useState([]),[S,I]=s.useState(""),[f,o]=s.useState([]);s.useState(""),s.useEffect(()=>{const n=sessionStorage.getItem("leadsData");if(n){const x=JSON.parse(n),c=[...new Set(x.map(d=>d.SENDER_STATE))];P(c)}},[]),s.useEffect(()=>{if(S){const n=sessionStorage.getItem("leadsData");if(n){const c=JSON.parse(n).filter(d=>d.SENDER_STATE===S).map(d=>d.SENDER_CITY);u(c),o(c)}}else u([]),o([])},[S]);const C=()=>{j&&j(E,h)};return e.jsx("div",{children:e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsx(_,{dateAdapter:v,children:e.jsx(w,{label:"Start Date",value:E,onChange:T,renderInput:n=>e.jsx(W,{...n,fullWidth:!0}),sx:{width:"100%"}})})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(_,{dateAdapter:v,children:e.jsx(w,{label:"End Date",value:h,onChange:D,renderInput:n=>e.jsx(W,{...n,fullWidth:!0}),sx:{width:"100%"}})})}),e.jsx(l,{item:!0,xs:12,display:"flex",justifyContent:"center",children:e.jsx(g,{variant:"contained",onClick:C,children:"Filter"})})]})})},Te=()=>{const j=N().subtract(1,"days").format("YYYY-MM-DD"),E=N().format("YYYY-MM-DD"),[T,h]=s.useState([]),[D,p]=s.useState(!1),[P,M]=s.useState(""),[u,S]=s.useState([]),[I,f]=s.useState([]),[o,C]=s.useState(5),[n,x]=s.useState(1),[c,d]=s.useState(N(`${j} 22:00:00`).format("YYYY-MM-DD HH:mm:ss")),[Y,k]=s.useState(N(`${E} 10:00:00`).format("YYYY-MM-DD HH:mm:ss")),[i,F]=s.useState(!1),[m,U]=s.useState(!1);s.useState();const[$,B]=s.useState([]);s.useEffect(()=>{(m||i)&&L.get(`${R.apiUrl}/leads/leadsData/?startTime=${c}&endTime=${Y}`).then(t=>{t.data.data.RESPONSE.length>0&&(i?(h(t.data.data.RESPONSE),f(t.data.data.RESPONSE)):(sessionStorage.setItem("leadsData",JSON.stringify(t.data.data.RESPONSE)),h(t.data.data.RESPONSE),f(t.data.data.RESPONSE)))}).catch(t=>{var r,O;p(!0),M(((O=(r=t.response)==null?void 0:r.data)==null?void 0:O.message)||"An error occurred while fetching leads data"),console.error("Error:",t)})},[c,Y,m]),s.useEffect(()=>{if(!i){const t=sessionStorage.getItem("leadsData");t&&(h(JSON.parse(t)),f(JSON.parse(t)))}},[i,D,u,m]),s.useEffect(()=>{L.get(`${R.apiUrl}/leads/getFollowingLeadsMobile`).then(t=>{S(t.data)}).catch(t=>{console.log("Error Following Data Can't fetched.")})},[]),s.useEffect(()=>{L.get(`${R.apiUrl}/customer/getCustomer`).then(t=>{B(t.data)}).catch(t=>{console.log("Error Customer Data Can't fetched.")})},[]);const H=(t,r)=>{d(t),k(r)},b=I.filter(t=>!u.some(r=>r.leads_mobile===t.SENDER_MOBILE)&&!$.some(r=>r.cust_mobile===t.SENDER_MOBILE)),J=t=>{const r=parseInt(t.target.value,10);r==1?(C(b.length),x(1)):(C(r),x(1))},Q=(n-1)*o,z=n*o,G=b.slice(Q,z);return e.jsxs("div",{children:[i&&!m&&e.jsx("h1",{className:"text-center",children:"Filtered Leads Index"}),!i&&m&&e.jsx("h1",{className:"text-center",children:"Today Leads"}),!i&&!m&&e.jsx("h1",{className:"text-center",children:"Leads Index"}),i?e.jsx(ce,{onFilterChange:H}):e.jsx(e.Fragment,{}),e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(V,{data:T,setData:f})}),e.jsx(l,{item:!0,xs:4,display:"flex",justifyContent:"center",children:i?e.jsxs(g,{onClick:()=>F(!1),variant:"contained",children:[" ","Cancel Filter"]}):e.jsxs(e.Fragment,{children:[e.jsxs(g,{onClick:()=>F(!0),variant:"contained",children:[" ","Apply Filter"]}),e.jsx(g,{onClick:()=>U(!0),style:{marginLeft:"30px"},variant:"contained",children:"Today Leads"})]})}),e.jsx(l,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(ae,{children:e.jsxs(se,{value:o,onChange:J,children:[e.jsx(y,{value:5,children:"5 Per Page"}),e.jsx(y,{value:10,children:"10 Per Page"}),e.jsx(y,{value:15,children:"15 Per Page"}),e.jsx(y,{value:1,children:"All Per Page"})]})})})]}),e.jsx(X,{component:q,className:"mt-3",children:e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(A,{children:[e.jsx(a,{style:{fontWeight:"bold"},children:"S.No"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Name"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Mobile Number"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Email"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Company"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Address"}),e.jsx(a,{style:{fontWeight:"bold"},children:"City"}),e.jsx(a,{style:{fontWeight:"bold"},children:"State"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Product Name"})]})}),e.jsx(te,{children:G.map((t,r)=>e.jsxs(A,{children:[e.jsx(a,{children:r+1}),e.jsx(a,{children:t.SENDER_NAME}),e.jsx(a,{children:t.SENDER_MOBILE}),e.jsx(a,{children:t.SENDER_EMAIL}),e.jsx(a,{children:t.SENDER_COMPANY}),e.jsx(a,{children:t.SENDER_ADDRESS}),e.jsx(a,{children:t.SENDER_CITY}),e.jsx(a,{children:t.SENDER_STATE}),e.jsx(a,{children:t.QUERY_PRODUCT_NAME})]},t.UNIQUE_QUERY_ID))})]})}),e.jsx(l,{container:!0,spacing:2,display:"flex",justifyContent:"center",className:"mt-4",children:e.jsx(K,{spacing:2,children:e.jsx(re,{count:Math.ceil(b.length/o),page:n,onChange:(t,r)=>x(r),size:"small",style:{cursor:"pointer","&:hover":{backgroundColor:"transparent"}}})})}),e.jsxs(ne,{open:D,onClose:()=>p(!1),children:[e.jsx(oe,{className:"text-center bg-danger",children:"ERROR"}),e.jsx(ie,{className:"mt-3",children:e.jsx("p",{children:P})}),e.jsx(le,{children:e.jsx(g,{onClick:()=>p(!1),children:"Close"})})]})]})};export{Te as default};

import{r as a,j as e,G as l,d as j,c as P,m as X,S as Z}from"./index-CTTX9ijT.js";import{a as R}from"./axios-C6NQisi-.js";import{h as F}from"./moment-G82_0lEo.js";import{S as ee,M as b,T as te,a as ae,b as se,c as A,d as s,e as re}from"./Search-CCLIb58Y.js";import{L as _,A as v,D as w}from"./DateTimePicker-D5jORtLV.js";import{T as W,S as ne}from"./TextField-Dktkde7T.js";import{F as oe}from"./OutlinedInput-C8Fn8aqk.js";import{P as le}from"./Pagination-D93ObAOZ.js";import{D as ie,a as ce,b as de}from"./DialogContent-BtWOILlZ.js";import{D as he}from"./DialogTitle-C9GyaUvU.js";import"./Tabs-C19gcznY.js";import"./InputAdornment-Biy7BR48.js";import"./ListItem-B5_SDwlb.js";import"./Popper-C-rgUV0B.js";const ue=({onFilterChange:m})=>{const[E,N]=a.useState(null),[h,D]=a.useState(null),[C,y]=a.useState([]),[L,g]=a.useState([]),[S,M]=a.useState(""),[f,i]=a.useState([]);a.useState(""),a.useEffect(()=>{const n=sessionStorage.getItem("leadsData");if(n){const u=JSON.parse(n),c=[...new Set(u.map(d=>d.SENDER_STATE))];y(c)}},[]),a.useEffect(()=>{if(S){const n=sessionStorage.getItem("leadsData");if(n){const c=JSON.parse(n).filter(d=>d.SENDER_STATE===S).map(d=>d.SENDER_CITY);g(c),i(c)}}else g([]),i([])},[S]);const p=()=>{m&&m(E,h)};return e.jsx("div",{children:e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsx(_,{dateAdapter:v,children:e.jsx(w,{label:"Start Date",value:E,onChange:N,renderInput:n=>e.jsx(W,{...n,fullWidth:!0}),sx:{width:"100%"}})})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(_,{dateAdapter:v,children:e.jsx(w,{label:"End Date",value:h,onChange:D,renderInput:n=>e.jsx(W,{...n,fullWidth:!0}),sx:{width:"100%"}})})}),e.jsx(l,{item:!0,xs:12,display:"flex",justifyContent:"center",children:e.jsx(j,{variant:"contained",onClick:p,children:"Filter"})})]})})},Te=()=>{const m=F().subtract(1,"days").format("YYYY-MM-DD"),E=F().format("YYYY-MM-DD");console.log(`${m},${E}`);const[N,h]=a.useState([]),[D,C]=a.useState(!1),[y,L]=a.useState(""),[g,S]=a.useState([]),[M,f]=a.useState([]),[i,p]=a.useState(5),[n,u]=a.useState(1),[c,d]=a.useState(F(`${m} 22:00:00`).format("YYYY-MM-DD HH:mm:ss")),[I,U]=a.useState(F().format("YYYY-MM-DD HH:mm:ss")),[o,O]=a.useState(!1),[x,$]=a.useState(!1);a.useState();const[B,H]=a.useState([]),[J,Y]=a.useState(!1);a.useEffect(()=>{(x||o)&&R.get(`${P.apiUrl}/leads/leadsData/?startTime=${c}&endTime=${I}`).then(t=>{t.data.data.RESPONSE.length>0&&(console.log(t.data.data.RESPONSE),o?(h(t.data.data.RESPONSE),f(t.data.data.RESPONSE)):(sessionStorage.setItem("leadsData",JSON.stringify(t.data.data.RESPONSE)),h(t.data.data.RESPONSE),f(t.data.data.RESPONSE)))}).catch(t=>{var r,k;C(!0),L(((k=(r=t.response)==null?void 0:r.data)==null?void 0:k.message)||"An error occurred while fetching leads data"),console.error("Error:",t)})},[c,I,x]),a.useEffect(()=>{if(!o){const t=sessionStorage.getItem("leadsData");t&&(h(JSON.parse(t)),f(JSON.parse(t)))}},[o,D,g,x]),a.useEffect(()=>{R.get(`${P.apiUrl}/leads/getFollowingLeadsMobile`).then(t=>{S(t.data)}).catch(t=>{console.log("Error Following Data Can't fetched.")})},[]),a.useEffect(()=>{R.get(`${P.apiUrl}/customer/getCustomer`).then(t=>{H(t.data)}).catch(t=>{console.log("Error Customer Data Can't fetched.")})},[]);const Q=(t,r)=>{d(t),U(r)},T=M.filter(t=>!g.some(r=>r.leads_mobile===t.SENDER_MOBILE)&&!B.some(r=>r.cust_mobile===t.SENDER_MOBILE)),z=t=>{const r=parseInt(t.target.value,10);r==1?(p(T.length),u(1)):(p(r),u(1))},G=()=>{$(!0),Y(!0),setTimeout(()=>{Y(!1)},3e5)},q=(n-1)*i,K=n*i,V=T.slice(q,K);return e.jsxs("div",{children:[o&&!x&&e.jsx("h1",{className:"text-center",children:"Filtered Leads Index"}),!o&&x&&e.jsx("h1",{className:"text-center",children:"Today Leads"}),!o&&!x&&e.jsx("h1",{className:"text-center",children:"Leads Index"}),o?e.jsx(ue,{onFilterChange:Q}):e.jsx(e.Fragment,{}),e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(ee,{data:N,setData:f})}),e.jsx(l,{item:!0,xs:4,display:"flex",justifyContent:"center",children:o?e.jsxs(j,{onClick:()=>O(!1),variant:"contained",children:[" ","Cancel Filter"]}):e.jsxs(e.Fragment,{children:[e.jsxs(j,{onClick:()=>O(!0),variant:"contained",children:[" ","Apply Filter"]}),e.jsx(j,{onClick:G,style:{marginLeft:"30px"},variant:"contained",disabled:J,children:"Today Leads"})]})}),e.jsx(l,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(oe,{children:e.jsxs(ne,{value:i,onChange:z,children:[e.jsx(b,{value:5,children:"5 Per Page"}),e.jsx(b,{value:10,children:"10 Per Page"}),e.jsx(b,{value:15,children:"15 Per Page"}),e.jsx(b,{value:1,children:"All Per Page"})]})})})]}),e.jsx(te,{component:X,className:"mt-3",children:e.jsxs(ae,{children:[e.jsx(se,{children:e.jsxs(A,{children:[e.jsx(s,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:"S.No"}),e.jsx(s,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:"Name"}),e.jsx(s,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:"Mobile Number"}),e.jsx(s,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:"Email"}),e.jsx(s,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:"Company"}),e.jsx(s,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:"Address"}),e.jsx(s,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:"City"}),e.jsx(s,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:"State"}),e.jsx(s,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:"Product Name"})]})}),e.jsx(re,{children:V.map((t,r)=>e.jsxs(A,{children:[e.jsx(s,{children:r+1}),e.jsx(s,{children:t.SENDER_NAME}),e.jsx(s,{children:t.SENDER_MOBILE}),e.jsx(s,{children:t.SENDER_EMAIL}),e.jsx(s,{children:t.SENDER_COMPANY}),e.jsx(s,{children:t.SENDER_ADDRESS}),e.jsx(s,{children:t.SENDER_CITY}),e.jsx(s,{children:t.SENDER_STATE}),e.jsx(s,{children:t.QUERY_PRODUCT_NAME})]},t.UNIQUE_QUERY_ID))})]})}),e.jsx(l,{container:!0,spacing:2,display:"flex",justifyContent:"center",className:"mt-4",children:e.jsx(Z,{spacing:2,children:e.jsx(le,{count:Math.ceil(T.length/i),page:n,onChange:(t,r)=>u(r),size:"small",style:{cursor:"pointer","&:hover":{backgroundColor:"transparent"}}})})}),e.jsxs(ie,{open:D,onClose:()=>C(!1),children:[e.jsx(he,{className:"text-center bg-danger",children:"ERROR"}),e.jsx(ce,{className:"mt-3",children:e.jsx("p",{children:y})}),e.jsx(de,{children:e.jsx(j,{onClick:()=>C(!1),children:"Close"})})]})]})};export{Te as default};

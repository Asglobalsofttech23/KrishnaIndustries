import{r as s,j as e,G as l,d as j,c as F,m as ie,S as oe}from"./index-CTTX9ijT.js";import{a as Y}from"./axios-C6NQisi-.js";import{h as P}from"./moment-G82_0lEo.js";import{L as Q,A as q,D as $}from"./DateTimePicker-D5jORtLV.js";import{T as x,S as de}from"./TextField-Dktkde7T.js";import{M as R,S as ce,T as me,a as he,b as ue,c as B,d as o,e as xe}from"./Search-CCLIb58Y.js";import{C as fe}from"./ConvertCustomer-CBC3Ubn-.js";import{F as je}from"./OutlinedInput-C8Fn8aqk.js";import{P as Ee}from"./Pagination-D93ObAOZ.js";import{D as A,a as O,b as U}from"./DialogContent-BtWOILlZ.js";import{D as ge}from"./DialogTitle-C9GyaUvU.js";import"./Tabs-C19gcznY.js";import"./InputAdornment-Biy7BR48.js";import"./ListItem-B5_SDwlb.js";import"./Popper-C-rgUV0B.js";const Se=({onFilterChange:p})=>{const[a,r]=s.useState(null),[D,m]=s.useState(null),[T,C]=s.useState([]),[c,_]=s.useState([]),[f,d]=s.useState(""),[n,h]=s.useState([]);s.useState(""),s.useEffect(()=>{const u=sessionStorage.getItem("leadsData");if(u){const v=JSON.parse(u),b=[...new Set(v.map(S=>S.SENDER_STATE))];C(b)}},[]),s.useEffect(()=>{if(f){const u=sessionStorage.getItem("leadsData");if(u){const b=JSON.parse(u).filter(S=>S.SENDER_STATE===f).map(S=>S.SENDER_CITY);_(b),h(b)}}else _([]),h([])},[f]);const g=()=>{p&&p(a,D)};return e.jsx("div",{children:e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsx(Q,{dateAdapter:q,children:e.jsx($,{label:"Start Date",value:a,onChange:r,renderInput:u=>e.jsx(x,{...u,fullWidth:!0}),sx:{width:"100%"}})})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(Q,{dateAdapter:q,children:e.jsx($,{label:"End Date",value:D,onChange:m,renderInput:u=>e.jsx(x,{...u,fullWidth:!0}),sx:{width:"100%"}})})}),e.jsx(l,{item:!0,xs:12,display:"flex",justifyContent:"center",children:e.jsx(j,{variant:"contained",onClick:g,children:"Filter"})})]})})},De=({onClose:p,data:a})=>{const[r,D]=s.useState({emp_id:sessionStorage.getItem("emp_id"),leads_id:a.UNIQUE_QUERY_ID,leads_name:a?a.SENDER_NAME:"",leads_mobile:a?a.SENDER_MOBILE:"",leads_email:a?a.SENDER_EMAIL:"",leads_company:a?a.SENDER_COMPANY:"",leads_address:a?a.SENDER_ADDRESS:"",leads_state:a?a.SENDER_STATE:"",leads_city:a?a.SENDER_CITY:"",product_name:a?a.QUERY_PRODUCT_NAME:"",leads_query:"",remember:"",reminder_date:""}),[m,T]=s.useState({leads_query:"",remember:"",reminder_date:""}),C=(f,d)=>{let n="";const h=d&&typeof d=="string"?d.trim():d;switch(f){case"leads_query":h||(n="Leads Query Message is Required");break;case"remember":h?h==="yes"&&!r.reminder_date&&(n="Reminder Date is Required"):n="Please Select one";break}return n},c=f=>{const{name:d,value:n}=f.target,h=C(d,n);D({...r,[d]:n}),T({...m,[d]:h})},_=f=>{f.preventDefault();let d={};Object.keys(r).forEach(n=>{const h=r[n],g=C(n,h);g&&(d[n]=g)}),Object.keys(d).length>0&&T(d),Y.post(`${F.apiUrl}/leads/saveEmpLeads`,r).then(n=>{console.log("Data Added Successfully.",n),p()}).catch(n=>{console.log("Data is not added",n)})};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-center",children:"Follow Leads"}),e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:6,children:e.jsx(x,{fullWidth:!0,name:"leads_name",label:"Lead Name",value:r.leads_name,onChange:c})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(x,{fullWidth:!0,name:"leads_mobile",label:"Lead Mobile",value:r.leads_mobile,onChange:c})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(x,{fullWidth:!0,name:"leads_email",label:"Lead Email",value:r.leads_email,onChange:c})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(x,{fullWidth:!0,name:"leads_company",label:"Lead Company",value:r.leads_company,onChange:c})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(x,{fullWidth:!0,name:"leads_address",label:"Lead Address",value:r.leads_address,onChange:c})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(x,{fullWidth:!0,name:"leads_state",label:"Lead State",value:r.leads_state,onChange:c})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(x,{fullWidth:!0,name:"leads_city",label:"Lead City",value:r.leads_city,onChange:c})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(x,{fullWidth:!0,name:"product_name",label:"Product Name",value:r.product_name,onChange:c})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(x,{fullWidth:!0,name:"leads_query",label:"Leads Query",value:r.leads_query,onChange:c,error:!!m.leads_query,helperText:m.leads_query})}),e.jsx(l,{item:!0,xs:6,children:e.jsxs(x,{fullWidth:!0,select:!0,name:"remember",label:"Remember",value:r.remember,onChange:c,error:!!m.remember,helperText:m.remember,children:[e.jsx(R,{value:"Yes",children:"Yes"}),e.jsx(R,{value:"No",children:"No"})]})}),r.remember==="Yes"&&e.jsx(l,{item:!0,xs:6,children:e.jsx(x,{fullWidth:!0,name:"reminder_date",label:"Reminder Date",type:"date",value:r.reminder_date,onChange:c,error:!!m.reminder_date,helperText:m.reminder_date,InputLabelProps:{shrink:!0}})}),e.jsx(l,{item:!0,xs:12,display:"flex",justifyContent:"center",children:e.jsx(j,{onClick:_,children:"Submit"})})]})]})},Ae=()=>{const p=P().subtract(1,"days").format("YYYY-MM-DD");P().format("YYYY-MM-DD");const[a,r]=s.useState([]),[D,m]=s.useState(!1),[T,C]=s.useState(""),[c,_]=s.useState([]),[f,d]=s.useState([]),[n,h]=s.useState(5),[g,u]=s.useState(1),[v,b]=s.useState(P(`${p} 22:00:00`).format("YYYY-MM-DD HH:mm:ss")),[S,H]=s.useState(P().format("YYYY-MM-DD HH:mm:ss")),[E,W]=s.useState(!1),[y,J]=s.useState(!1),[k,I]=s.useState(!1),[z,G]=s.useState(),[V,K]=s.useState([]),[w,L]=s.useState(!1),[X,Z]=s.useState([]);s.useEffect(()=>{(y||E)&&Y.get(`${F.apiUrl}/leads/leadsData/?startTime=${v}&endTime=${S}`).then(t=>{t.data.data.RESPONSE.length>0&&(E?(r(t.data.data.RESPONSE),d(t.data.data.RESPONSE)):(sessionStorage.setItem("leadsData",JSON.stringify(t.data.data.RESPONSE)),r(t.data.data.RESPONSE),d(t.data.data.RESPONSE)))}).catch(t=>{var i,N;m(!0),C(((N=(i=t.response)==null?void 0:i.data)==null?void 0:N.message)||"An error occurred while fetching leads data"),console.error("Error:",t)})},[v,S,y]),s.useEffect(()=>{if(!E){const t=sessionStorage.getItem("leadsData");t&&(r(JSON.parse(t)),d(JSON.parse(t)))}},[E,D,c,y]),s.useEffect(()=>{Y.get(`${F.apiUrl}/leads/getFollowingLeadsMobile`).then(t=>{_(t.data)}).catch(t=>{console.log("Error Following Data Can't fetched.")})},[k]),s.useEffect(()=>{Y.get(`${F.apiUrl}/customer/getCustomer`).then(t=>{K(t.data)}).catch(t=>{console.log("Error Customer Data Can't fetched.")})},[w]);const ee=(t,i)=>{b(t),H(i)},M=f.filter(t=>!c.some(i=>i.leads_mobile===t.SENDER_MOBILE)&&!V.some(i=>i.cust_mobile===t.SENDER_MOBILE)),te=t=>{const i=parseInt(t.target.value,10);i==1?(h(M.length),u(1)):(h(i),u(1))},se=(g-1)*n,ae=g*n,re=M.slice(se,ae),le=t=>{if(a.length>0){const i=a.find(N=>N.UNIQUE_QUERY_ID===t);i&&(G(i),I(!0))}},ne=t=>{if(a.length>0){const i=a.find(N=>N.UNIQUE_QUERY_ID===t);i&&(Z(i),L(!0))}};return e.jsxs("div",{children:[E&&!y&&e.jsx("h1",{className:"text-center",children:"Filtered Leads Index"}),!E&&y&&e.jsx("h1",{className:"text-center",children:"Today Leads Index"}),!E&&!y&&e.jsx("h1",{className:"text-center",children:"Leads Index"}),E?e.jsx(Se,{onFilterChange:ee}):e.jsx(e.Fragment,{}),e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(ce,{data:a,setData:d})}),e.jsx(l,{item:!0,xs:4,display:"flex",justifyContent:"center",children:E?e.jsxs(j,{onClick:()=>W(!1),variant:"contained",children:[" ","Cancel Filter"]}):e.jsxs(e.Fragment,{children:[e.jsxs(j,{onClick:()=>W(!0),variant:"contained",children:[" ","Applay Filter"]}),e.jsx(j,{onClick:()=>J(!0),style:{marginLeft:"30px"},variant:"contained",children:"Today Leads"})]})}),e.jsx(l,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(je,{children:e.jsxs(de,{value:n,onChange:te,children:[e.jsx(R,{value:5,children:"5 Per Page"}),e.jsx(R,{value:10,children:"10 Per Page"}),e.jsx(R,{value:15,children:"15 Per Page"}),e.jsx(R,{value:1,children:"All Per Page"})]})})})]}),e.jsx(me,{component:ie,className:"mt-3",children:e.jsxs(he,{children:[e.jsx(ue,{children:e.jsxs(B,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:[e.jsx(o,{style:{fontWeight:"bold"},children:"S.No"}),e.jsx(o,{style:{fontWeight:"bold"},children:"Name"}),e.jsx(o,{style:{fontWeight:"bold"},children:"Mobile Number"}),e.jsx(o,{style:{fontWeight:"bold"},children:"Email"}),e.jsx(o,{style:{fontWeight:"bold"},children:"Company"}),e.jsx(o,{style:{fontWeight:"bold"},children:"Address"}),e.jsx(o,{style:{fontWeight:"bold"},children:"City"}),e.jsx(o,{style:{fontWeight:"bold"},children:"State"}),e.jsx(o,{style:{fontWeight:"bold"},children:"Product Name"}),e.jsx(o,{style:{fontWeight:"bold"},children:"Action"})]})}),e.jsx(xe,{children:re.map((t,i)=>e.jsxs(B,{children:[e.jsx(o,{children:i+1}),e.jsx(o,{children:t.SENDER_NAME}),e.jsx(o,{children:t.SENDER_MOBILE}),e.jsx(o,{children:t.SENDER_EMAIL}),e.jsx(o,{children:t.SENDER_COMPANY}),e.jsx(o,{children:t.SENDER_ADDRESS}),e.jsx(o,{children:t.SENDER_CITY}),e.jsx(o,{children:t.SENDER_STATE}),e.jsx(o,{children:t.QUERY_PRODUCT_NAME}),e.jsxs(o,{children:[e.jsx(j,{onClick:()=>le(t.UNIQUE_QUERY_ID),children:"Follow"}),e.jsx(j,{onClick:()=>ne(t.UNIQUE_QUERY_ID),children:"Convert"})]})]},t.UNIQUE_QUERY_ID))})]})}),e.jsx(l,{container:!0,spacing:2,display:"flex",justifyContent:"center",className:"mt-4",children:e.jsx(oe,{spacing:2,children:e.jsx(Ee,{count:Math.ceil(M.length/n),page:g,onChange:(t,i)=>u(i),size:"small",style:{cursor:"pointer","&:hover":{backgroundColor:"transparent"}}})})}),e.jsxs(A,{open:D,onClose:()=>m(!1),children:[e.jsx(ge,{className:"text-center bg-danger",children:"ERROR"}),e.jsx(O,{className:"mt-3",children:e.jsx("p",{children:T})}),e.jsx(U,{children:e.jsx(j,{onClick:()=>m(!1),children:"Close"})})]}),e.jsxs(A,{open:k,onClose:()=>I(!1),maxWidth:"md",children:[e.jsx(O,{children:e.jsx(De,{data:z,onClose:()=>I(!1)})}),e.jsx(U,{children:e.jsx(j,{onClick:()=>I(!1),children:"Close"})})]}),e.jsxs(A,{open:w,onClose:()=>L(!1),maxWidth:"md",children:[e.jsx(O,{children:e.jsx(fe,{data:X,onClose:()=>L(!1)})}),e.jsx(U,{children:e.jsx(j,{onClick:()=>L(!1),children:"Close"})})]})]})};export{Ae as default};

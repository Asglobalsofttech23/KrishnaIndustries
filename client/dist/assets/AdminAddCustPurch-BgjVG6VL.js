import{r as u,n as q,c as y,j as e,G as c,d as D}from"./index-CTTX9ijT.js";import{a as f}from"./axios-C6NQisi-.js";import{T as i}from"./TextField-Dktkde7T.js";import{M as m}from"./Search-CCLIb58Y.js";const I=({cust_id:h,onClose:_})=>{const[g,C]=u.useState([]),[j,F]=u.useState([]),P=q(),[n,T]=u.useState({cust_id:h||"",pro_id:"",quantity:"",price:"",payment_type:"",advance:"",balance:"",total:""}),[a,b]=u.useState({cust_id:h,pro_id:"",quantity:"",price:"",payment_type:"",advance:"",balance:"",total:""});u.useEffect(()=>{f.get(`${y.apiUrl}/product/getProductData`).then(t=>{C(t.data)}).catch(t=>{console.log("Customer purchase data is not fetched.")})},[]),u.useEffect(()=>{f.get(`${y.apiUrl}/customer/getCustomerForAdmin`).then(t=>{F(t.data)}).catch(t=>{console.log("Customer data is not fetched.")})},[]);const v=(t,r)=>{r&&typeof r=="string"&&r.trim()},o=t=>{const{name:r,value:s}=t.target;let l={...n,[r]:s};if(r==="payment_type"&&s==="partial"){const d=parseFloat(l.total||0),p=parseFloat(l.advance||0);l.balance=(d-p).toFixed(2)}else if(r==="advance"){const d=parseFloat(l.total||0),p=parseFloat(s||0);l.balance=(d-p).toFixed(2)}else if(r==="quantity"||r==="price"){const d=parseFloat(l.quantity||0),p=parseFloat(l.price||0);l.total=(d*p).toFixed(2)}const x=v(r,s);T(l),b({...a,[r]:x})},S=t=>{t.preventDefault();let r={};if(Object.keys(n).forEach(s=>{const l=n[s],x=v(s,l);x&&(r=x)}),Object.keys(r).length>0){b(r);return}f.post(`${y.apiUrl}/cust_purch/addCustPurch`,n).then(s=>{_(),P("/CustPurchIndex")}).catch(s=>{console.log("Error:",s)})};return e.jsx("div",{children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:6,children:h?e.jsx(i,{select:!0,fullWidth:!0,name:"cust_id",label:"Select customer",onChange:o,value:n.cust_id,disabled:!0,children:j.map(t=>e.jsx(m,{value:t.cust_id,children:t.cust_name},t.cust_id))}):e.jsx(i,{select:!0,fullWidth:!0,name:"cust_id",label:"Select customer",onChange:o,value:n.cust_id,error:!!a.cust_id,helperText:a.cust_id,children:j.map(t=>e.jsx(m,{value:t.cust_id,children:t.cust_name},t.cust_id))})}),e.jsx(c,{item:!0,xs:6,children:e.jsx(i,{select:!0,fullWidth:!0,name:"pro_id",label:"Select Product Name",onChange:o,value:n.pro_id,error:!!a.pro_id,helperText:a.pro_id,children:g.map(t=>e.jsx(m,{value:t.pro_id,children:t.pro_name},t.pro_id))})}),e.jsx(c,{item:!0,xs:6,children:e.jsx(i,{fullWidth:!0,name:"quantity",label:"Quantity",type:"number",onChange:o,value:n.quantity,error:!!a.quantity,helperText:a.quantity})}),e.jsx(c,{item:!0,xs:6,children:e.jsx(i,{fullWidth:!0,name:"price",label:"Price",type:"number",onChange:o,value:n.price,error:!!a.price,helperText:a.price})}),e.jsx(c,{item:!0,xs:6,children:e.jsxs(i,{select:!0,fullWidth:!0,name:"payment_type",label:"Select Payment type",onChange:o,value:n.payment_type,error:!!a.payment_type,helperText:a.payment_type,children:[e.jsx(m,{value:"full",children:"Full Payment"}),e.jsx(m,{value:"partial",children:"Partial Payment"})]})}),e.jsx(c,{item:!0,xs:6,children:e.jsx(i,{fullWidth:!0,name:"total",label:"Total",type:"number",onChange:o,value:n.total,error:!!a.total,helperText:a.total})}),e.jsx(c,{item:!0,xs:6,children:e.jsx(i,{fullWidth:!0,name:"advance",label:"Amount",type:"number",onChange:o,value:n.advance,error:!!a.advance,helperText:a.advance})}),e.jsx(c,{item:!0,xs:6,children:e.jsx(i,{fullWidth:!0,name:"balance",label:"Balance Amount",type:"number",onChange:o,value:n.balance,error:!!a.balance,helperText:a.balance})}),e.jsx(c,{item:!0,xs:12,display:"flex",justifyContent:"center",children:e.jsx(D,{onClick:S,children:"Submit"})})]})})};export{I as A};

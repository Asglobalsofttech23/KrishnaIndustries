import{r as i,c as _,j as e,G as o,d as m,w as M,S as G}from"./index-BFgOO9FV.js";import{a as v}from"./axios-CMf68hJO.js";import{S as Q,T as R,a as z,b as H,c as q,d as a,e as V}from"./Search-BptgNfeq.js";import{A as J}from"./AdminAddCustPurch-ZebfvXbs.js";import{T as p,S as K}from"./TextField-uMyB6taY.js";import{M as j}from"./MenuItem-DdWCPvaA.js";import{F as L}from"./OutlinedInput-CU74RVD_.js";import{P as X}from"./Pagination-Jcemn9fm.js";import{D as A,a as U,b as E}from"./DialogContent-BR2G1wlf.js";const Y=({data:s,onClose:F})=>{const[k,S]=i.useState([]),[C,W]=i.useState([]),[c,P]=i.useState({cust_id:s?s.cust_id:"",pro_id:s?s.pro_id:"",quantity:s?s.quantity:"",price:s?s.price:"",payment_type:s?s.payment_type:"",advance:s?s.advance:"",balance:s?s.balance:"",total:s?s.total:""}),[l,f]=i.useState({cust_id:"",pro_id:"",quantity:"",price:"",payment_type:"",advance:"",balance:"",total:""});i.useEffect(()=>{v.get(`${_.apiUrl}/product/getProductData`).then(n=>{S(n.data)}).catch(n=>{console.log("Customer purchase data is not fetched.")})},[]),i.useEffect(()=>{v.get(`${_.apiUrl}/customer/getCustomerForAdmin`).then(n=>{W(n.data)}).catch(n=>{console.log("Customer data is not fetched.")})},[]);const D=(n,r)=>{r&&typeof r=="string"&&r.trim()},d=n=>{const{name:r,value:h}=n.target;let u={...c,[r]:h};if(r==="payment_type"&&h==="partial"){const y=parseFloat(u.total||0),g=parseFloat(u.advance||0);u.balance=(y-g).toFixed(2)}else if(r==="advance"){const y=parseFloat(u.total||0),g=parseFloat(h||0);u.balance=(y-g).toFixed(2)}else if(r==="quantity"||r==="price"){const y=parseFloat(u.quantity||0),g=parseFloat(u.price||0);u.total=(y*g).toFixed(2)}const b=D(r,h);P(u),f({...l,[r]:b})},T=n=>{n.preventDefault();let r={};if(Object.keys(c).forEach(h=>{const u=c[h],b=D(h,u);b&&(r=b)}),Object.keys(r).length>0){f(r);return}v.put(`${_.apiUrl}/cust_purch/updateCustPurch/${s.cust_purch_id}`,c).then(h=>{F()}).catch(h=>{console.log("Error:",h)})};return e.jsx("div",{children:e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:6,children:e.jsx(p,{select:!0,fullWidth:!0,name:"cust_id",label:"Select customer",onChange:d,value:c.cust_id,error:!!l.cust_id,helperText:l.cust_id,children:C.map(n=>e.jsx(j,{value:n.cust_id,children:n.cust_name},n.cust_id))})}),e.jsx(o,{item:!0,xs:6,children:e.jsx(p,{select:!0,fullWidth:!0,name:"pro_id",label:"Select Product Name",onChange:d,value:c.pro_id,error:!!l.pro_id,helperText:l.pro_id,children:k.map(n=>e.jsx(j,{value:n.pro_id,children:n.pro_name},n.pro_id))})}),e.jsx(o,{item:!0,xs:6,children:e.jsx(p,{fullWidth:!0,name:"quantity",label:"Quantity",type:"number",onChange:d,value:c.quantity,error:!!l.quantity,helperText:l.quantity})}),e.jsx(o,{item:!0,xs:6,children:e.jsx(p,{fullWidth:!0,name:"price",label:"Price",type:"number",onChange:d,value:c.price,error:!!l.price,helperText:l.price})}),e.jsx(o,{item:!0,xs:6,children:e.jsxs(p,{select:!0,fullWidth:!0,name:"payment_type",label:"Select Payment type",onChange:d,value:c.payment_type,error:!!l.payment_type,helperText:l.payment_type,children:[e.jsx(j,{value:"full",children:"Full Payment"}),e.jsx(j,{value:"partial",children:"Partial Payment"})]})}),e.jsx(o,{item:!0,xs:6,children:e.jsx(p,{fullWidth:!0,name:"total",label:"Total",type:"number",onChange:d,value:c.total,error:!!l.total,helperText:l.total})}),e.jsx(o,{item:!0,xs:6,children:e.jsx(p,{fullWidth:!0,name:"advance",label:"Amount",type:"number",onChange:d,value:c.advance,error:!!l.advance,helperText:l.advance})}),e.jsx(o,{item:!0,xs:6,children:e.jsx(p,{fullWidth:!0,name:"balance",label:"Balance Amount",type:"number",onChange:d,value:c.balance,error:!!l.balance,helperText:l.balance})}),e.jsx(o,{item:!0,xs:12,display:"flex",justifyContent:"center",children:e.jsx(m,{onClick:T,children:"Submit"})})]})})},ie=()=>{const[s,F]=i.useState([]),[k,S]=i.useState([]),[C,W]=i.useState(5),[c,P]=i.useState(1),[l,f]=i.useState(!1),[D,d]=i.useState(!1),[T,n]=i.useState(!1),[r,h]=i.useState([]),[u,b]=i.useState();i.useEffect(()=>{v.get(`${_.apiUrl}/cust_purch/getCustPurchDataForAdmin`).then(t=>{F(t.data),S(t.data)}).catch(t=>{console.log("Customer purchase data is not fetched.")})},[l,D,T]);const y=t=>{const x=s.find(B=>B.cust_purch_id===t);x&&(h(x),d(!0))},g=t=>{b(t),n(!0)},N=()=>{v.delete(`${_.apiUrl}/cust_purch/deleteCustPurch/${u}`).then(t=>{n(!1)}).catch(t=>{console.log("Error deleting data. Please try again later.")})},w=t=>{const x=parseInt(t.target.value,10);x==1?(W(s.length),P(1)):(W(x),P(1))},I=(c-1)*C,O=c*C,$=k.slice(I,O);return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-center",children:"Customer Index"}),e.jsxs(o,{container:!0,spacing:2,className:"mt-3",children:[e.jsx(o,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(m,{onClick:()=>f(!0),children:"Purchase Product"})}),e.jsx(o,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(Q,{data:s,setData:S})}),e.jsx(o,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(L,{children:e.jsxs(K,{value:C,onChange:w,children:[e.jsx(j,{value:5,children:"5 Per Page"}),e.jsx(j,{value:10,children:"10 Per Page"}),e.jsx(j,{value:15,children:"15 Per Page"}),e.jsx(j,{value:1,children:"All Per Page"})]})})})]}),e.jsx(R,{component:M,className:"mt-4",children:e.jsxs(z,{children:[e.jsx(H,{children:e.jsxs(q,{children:[e.jsx(a,{style:{fontWeight:"bold"},children:"S.No"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Customer Name"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Customer Mobile"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Customer Email"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Product Name"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Quantity"}),e.jsx(a,{style:{fontWeight:"bold"},children:"price"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Payment Type"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Advance"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Balance"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Total"}),e.jsx(a,{style:{fontWeight:"bold"},children:"Action"})]})}),e.jsx(V,{children:$.map((t,x)=>e.jsxs(q,{children:[e.jsx(a,{children:x+1}),e.jsx(a,{children:t.cust_name}),e.jsx(a,{children:t.cust_mobile}),e.jsx(a,{children:t.cust_email}),e.jsx(a,{children:t.pro_name}),e.jsx(a,{children:t.quantity}),e.jsx(a,{children:t.price}),e.jsx(a,{children:t.payment_type}),e.jsx(a,{children:t.advance}),e.jsx(a,{children:t.balance}),e.jsx(a,{children:t.total}),e.jsxs(a,{children:[e.jsx(m,{onClick:()=>y(t.cust_purch_id),children:"Edit"}),e.jsx(m,{onClick:()=>g(t.cust_purch_id),children:"Delete"})]})]},t.cust_purch_id))})]})}),e.jsx(o,{container:!0,spacing:2,display:"flex",justifyContent:"center",className:"mt-4",children:e.jsx(G,{spacing:2,children:e.jsx(X,{count:Math.ceil(s.length/C),page:c,onChange:(t,x)=>P(x),size:"small",style:{cursor:"pointer","&:hover":{backgroundColor:"transparent"}}})})}),e.jsxs(A,{open:l,onClose:()=>f(!1),maxWidth:"lg",children:[e.jsx(U,{children:e.jsx(J,{onClose:()=>f(!1)})}),e.jsx(E,{children:e.jsx(m,{onClick:()=>f(!1),children:"Close"})})]}),e.jsxs(A,{open:D,onClose:()=>d(!1),maxWidth:"lg",children:[e.jsx(U,{children:e.jsx(Y,{data:r,onClose:()=>d(!1)})}),e.jsx(E,{children:e.jsx(m,{onClick:()=>d(!1),children:"Close"})})]}),e.jsxs(A,{open:T,onClose:()=>n(!1),children:[e.jsx(U,{children:e.jsx("p",{children:"Are you sure you want to delete this Customer data?"})}),e.jsxs(E,{children:[e.jsx(m,{onClick:N,style:{backgroundColor:"red",color:"white"},children:"Delete"}),e.jsx(m,{onClick:()=>n(!1),style:{backgroundColor:"green",color:"white"},children:"Cancel"})]})]})]})};export{ie as default};

import{r as s,j as e,G as n,d as j,c as Y,w as oe,S as de}from"./index-BFgOO9FV.js";import{a as F}from"./axios-CMf68hJO.js";import{h as P}from"./moment-G82_0lEo.js";import{L as q,A as $,D as B}from"./DateTimePicker-Cw3MEjmR.js";import{T as u,S as ce}from"./TextField-uMyB6taY.js";import{M as v}from"./MenuItem-DdWCPvaA.js";import{S as me,T as he,a as ue,b as xe,c as H,d as o,e as fe}from"./Search-BptgNfeq.js";import{C as je}from"./ConvertCustomer-BEVl0711.js";import{F as Ee}from"./OutlinedInput-CU74RVD_.js";import{P as Se}from"./Pagination-Jcemn9fm.js";import{D as A,a as O,b as U}from"./DialogContent-BR2G1wlf.js";import{D as ge}from"./DialogTitle-Bwjr3vop.js";import"./Tabs-RtGtfztt.js";import"./InputAdornment-DDYrV0kf.js";import"./ListItem-YrdFOudX.js";import"./Popper-D6Ge9WxY.js";const De=({onFilterChange:y})=>{const[r,a]=s.useState(null),[S,x]=s.useState(null),[g,b]=s.useState([]),[m,D]=s.useState([]),[f,d]=s.useState(""),[l,c]=s.useState([]);s.useState(""),s.useEffect(()=>{const h=sessionStorage.getItem("leadsData");if(h){const N=JSON.parse(h),C=[...new Set(N.map(_=>_.SENDER_STATE))];b(C)}},[]),s.useEffect(()=>{if(f){const h=sessionStorage.getItem("leadsData");if(h){const C=JSON.parse(h).filter(_=>_.SENDER_STATE===f).map(_=>_.SENDER_CITY);D(C),c(C)}}else D([]),c([])},[f]);const p=()=>{y&&y(r,S)};return e.jsx("div",{children:e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:6,children:e.jsx(q,{dateAdapter:$,children:e.jsx(B,{label:"Start Date",value:r,onChange:a,renderInput:h=>e.jsx(u,{...h,fullWidth:!0}),sx:{width:"100%"}})})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(q,{dateAdapter:$,children:e.jsx(B,{label:"End Date",value:S,onChange:x,renderInput:h=>e.jsx(u,{...h,fullWidth:!0}),sx:{width:"100%"}})})}),e.jsx(n,{item:!0,xs:12,display:"flex",justifyContent:"center",children:e.jsx(j,{variant:"contained",onClick:p,children:"Filter"})})]})})},pe=({onClose:y,data:r})=>{const[a,S]=s.useState({emp_id:sessionStorage.getItem("emp_id"),leads_id:r.UNIQUE_QUERY_ID,leads_name:r?r.SENDER_NAME:"",leads_mobile:r?r.SENDER_MOBILE:"",leads_email:r?r.SENDER_EMAIL:"",leads_company:r?r.SENDER_COMPANY:"",leads_address:r?r.SENDER_ADDRESS:"",leads_state:r?r.SENDER_STATE:"",leads_city:r?r.SENDER_CITY:"",product_name:r?r.QUERY_PRODUCT_NAME:"",leads_query:"",remember:"",reminder_date:""}),[x,g]=s.useState({leads_query:"",remember:"",reminder_date:""}),b=(f,d)=>{let l="";const c=d&&typeof d=="string"?d.trim():d;switch(f){case"leads_query":c||(l="Leads Query Message is Required");break;case"remember":c?c==="yes"&&!a.reminder_date&&(l="Reminder Date is Required"):l="Please Select one";break}return l},m=f=>{const{name:d,value:l}=f.target,c=b(d,l);S({...a,[d]:l}),g({...x,[d]:c})},D=f=>{f.preventDefault();let d={};Object.keys(a).forEach(l=>{const c=a[l],p=b(l,c);p&&(d[l]=p)}),Object.keys(d).length>0&&g(d),F.post(`${Y.apiUrl}/leads/saveEmpLeads`,a).then(l=>{console.log("Data Added Successfully.",l),y()}).catch(l=>{console.log("Data is not added",l)})};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-center",children:"Follow Leads"}),e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:6,children:e.jsx(u,{fullWidth:!0,name:"leads_name",label:"Lead Name",value:a.leads_name,onChange:m})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(u,{fullWidth:!0,name:"leads_mobile",label:"Lead Mobile",value:a.leads_mobile,onChange:m})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(u,{fullWidth:!0,name:"leads_email",label:"Lead Email",value:a.leads_email,onChange:m})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(u,{fullWidth:!0,name:"leads_company",label:"Lead Company",value:a.leads_company,onChange:m})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(u,{fullWidth:!0,name:"leads_address",label:"Lead Address",value:a.leads_address,onChange:m})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(u,{fullWidth:!0,name:"leads_state",label:"Lead State",value:a.leads_state,onChange:m})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(u,{fullWidth:!0,name:"leads_city",label:"Lead City",value:a.leads_city,onChange:m})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(u,{fullWidth:!0,name:"product_name",label:"Product Name",value:a.product_name,onChange:m})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(u,{fullWidth:!0,name:"leads_query",label:"Leads Query",value:a.leads_query,onChange:m,error:!!x.leads_query,helperText:x.leads_query})}),e.jsx(n,{item:!0,xs:6,children:e.jsxs(u,{fullWidth:!0,select:!0,name:"remember",label:"Remember",value:a.remember,onChange:m,error:!!x.remember,helperText:x.remember,children:[e.jsx(v,{value:"Yes",children:"Yes"}),e.jsx(v,{value:"No",children:"No"})]})}),a.remember==="Yes"&&e.jsx(n,{item:!0,xs:6,children:e.jsx(u,{fullWidth:!0,name:"reminder_date",label:"Reminder Date",type:"date",value:a.reminder_date,onChange:m,error:!!x.reminder_date,helperText:x.reminder_date,InputLabelProps:{shrink:!0}})}),e.jsx(n,{item:!0,xs:12,display:"flex",justifyContent:"center",children:e.jsx(j,{onClick:D,children:"Submit"})})]})]})},Ue=()=>{const y=P().subtract(1,"days").format("YYYY-MM-DD"),r=P().format("YYYY-MM-DD"),[a,S]=s.useState([]),[x,g]=s.useState(!1),[b,m]=s.useState(""),[D,f]=s.useState([]),[d,l]=s.useState([]),[c,p]=s.useState(5),[h,N]=s.useState(1),[C,_]=s.useState(P(`${y} 22:00:00`).format("YYYY-MM-DD HH:mm:ss")),[W,J]=s.useState(P(`${r} 10:00:00`).format("YYYY-MM-DD HH:mm:ss")),[E,w]=s.useState(!1),[R,z]=s.useState(!1),[k,I]=s.useState(!1),[G,V]=s.useState(),[K,X]=s.useState([]),[Q,L]=s.useState(!1),[Z,ee]=s.useState([]);s.useEffect(()=>{(R||E)&&F.get(`${Y.apiUrl}/leads/leadsData/?startTime=${C}&endTime=${W}`).then(t=>{t.data.data.RESPONSE.length>0&&(E?(S(t.data.data.RESPONSE),l(t.data.data.RESPONSE)):(sessionStorage.setItem("leadsData",JSON.stringify(t.data.data.RESPONSE)),S(t.data.data.RESPONSE),l(t.data.data.RESPONSE)))}).catch(t=>{var i,T;g(!0),m(((T=(i=t.response)==null?void 0:i.data)==null?void 0:T.message)||"An error occurred while fetching leads data"),console.error("Error:",t)})},[C,W,R]),s.useEffect(()=>{if(!E){const t=sessionStorage.getItem("leadsData");t&&(S(JSON.parse(t)),l(JSON.parse(t)))}},[E,x,D,R]),s.useEffect(()=>{F.get(`${Y.apiUrl}/leads/getFollowingLeadsMobile`).then(t=>{f(t.data)}).catch(t=>{console.log("Error Following Data Can't fetched.")})},[k]),s.useEffect(()=>{F.get(`${Y.apiUrl}/customer/getCustomer`).then(t=>{X(t.data)}).catch(t=>{console.log("Error Customer Data Can't fetched.")})},[Q]);const te=(t,i)=>{_(t),J(i)},M=d.filter(t=>!D.some(i=>i.leads_mobile===t.SENDER_MOBILE)&&!K.some(i=>i.cust_mobile===t.SENDER_MOBILE)),se=t=>{const i=parseInt(t.target.value,10);i==1?(p(M.length),N(1)):(p(i),N(1))},ae=(h-1)*c,re=h*c,ne=M.slice(ae,re),le=t=>{if(a.length>0){const i=a.find(T=>T.UNIQUE_QUERY_ID===t);i&&(V(i),I(!0))}},ie=t=>{if(a.length>0){const i=a.find(T=>T.UNIQUE_QUERY_ID===t);i&&(ee(i),L(!0))}};return e.jsxs("div",{children:[E&&!R&&e.jsx("h1",{className:"text-center",children:"Filtered Leads Index"}),!E&&R&&e.jsx("h1",{className:"text-center",children:"Today Leads Index"}),!E&&!R&&e.jsx("h1",{className:"text-center",children:"Leads Index"}),E?e.jsx(De,{onFilterChange:te}):e.jsx(e.Fragment,{}),e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(me,{data:a,setData:l})}),e.jsx(n,{item:!0,xs:4,display:"flex",justifyContent:"center",children:E?e.jsxs(j,{onClick:()=>w(!1),variant:"contained",children:[" ","Cancel Filter"]}):e.jsxs(e.Fragment,{children:[e.jsxs(j,{onClick:()=>w(!0),variant:"contained",children:[" ","Applay Filter"]}),e.jsx(j,{onClick:()=>z(!0),style:{marginLeft:"30px"},variant:"contained",children:"Today Leads"})]})}),e.jsx(n,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(Ee,{children:e.jsxs(ce,{value:c,onChange:se,children:[e.jsx(v,{value:5,children:"5 Per Page"}),e.jsx(v,{value:10,children:"10 Per Page"}),e.jsx(v,{value:15,children:"15 Per Page"}),e.jsx(v,{value:1,children:"All Per Page"})]})})})]}),e.jsx(he,{component:oe,className:"mt-3",children:e.jsxs(ue,{children:[e.jsx(xe,{children:e.jsxs(H,{children:[e.jsx(o,{style:{fontWeight:"bold"},children:"S.No"}),e.jsx(o,{style:{fontWeight:"bold"},children:"Name"}),e.jsx(o,{style:{fontWeight:"bold"},children:"Mobile Number"}),e.jsx(o,{style:{fontWeight:"bold"},children:"Email"}),e.jsx(o,{style:{fontWeight:"bold"},children:"Company"}),e.jsx(o,{style:{fontWeight:"bold"},children:"Address"}),e.jsx(o,{style:{fontWeight:"bold"},children:"City"}),e.jsx(o,{style:{fontWeight:"bold"},children:"State"}),e.jsx(o,{style:{fontWeight:"bold"},children:"Product Name"}),e.jsx(o,{style:{fontWeight:"bold"},children:"Action"})]})}),e.jsx(fe,{children:ne.map((t,i)=>e.jsxs(H,{children:[e.jsx(o,{children:i+1}),e.jsx(o,{children:t.SENDER_NAME}),e.jsx(o,{children:t.SENDER_MOBILE}),e.jsx(o,{children:t.SENDER_EMAIL}),e.jsx(o,{children:t.SENDER_COMPANY}),e.jsx(o,{children:t.SENDER_ADDRESS}),e.jsx(o,{children:t.SENDER_CITY}),e.jsx(o,{children:t.SENDER_STATE}),e.jsx(o,{children:t.QUERY_PRODUCT_NAME}),e.jsxs(o,{children:[e.jsx(j,{onClick:()=>le(t.UNIQUE_QUERY_ID),children:"Follow"}),e.jsx(j,{onClick:()=>ie(t.UNIQUE_QUERY_ID),children:"Convert"})]})]},t.UNIQUE_QUERY_ID))})]})}),e.jsx(n,{container:!0,spacing:2,display:"flex",justifyContent:"center",className:"mt-4",children:e.jsx(de,{spacing:2,children:e.jsx(Se,{count:Math.ceil(M.length/c),page:h,onChange:(t,i)=>N(i),size:"small",style:{cursor:"pointer","&:hover":{backgroundColor:"transparent"}}})})}),e.jsxs(A,{open:x,onClose:()=>g(!1),children:[e.jsx(ge,{className:"text-center bg-danger",children:"ERROR"}),e.jsx(O,{className:"mt-3",children:e.jsx("p",{children:b})}),e.jsx(U,{children:e.jsx(j,{onClick:()=>g(!1),children:"Close"})})]}),e.jsxs(A,{open:k,onClose:()=>I(!1),maxWidth:"md",children:[e.jsx(O,{children:e.jsx(pe,{data:G,onClose:()=>I(!1)})}),e.jsx(U,{children:e.jsx(j,{onClick:()=>I(!1),children:"Close"})})]}),e.jsxs(A,{open:Q,onClose:()=>L(!1),maxWidth:"md",children:[e.jsx(O,{children:e.jsx(je,{data:Z,onClose:()=>L(!1)})}),e.jsx(U,{children:e.jsx(j,{onClick:()=>L(!1),children:"Close"})})]})]})};export{Ue as default};
